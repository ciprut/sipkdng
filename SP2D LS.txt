select distinct 
0 as ALLOWSUPERUSER,A.IDXKODE,A.IDXSKO,rtrim(A.IDXTTD) as IDXTTD,rtrim(A.KDSTATUS) as KDSTATUS, 
isnull((A.KEPERLUAN),'''')KEPERLUAN,isnull((A.NOKONTRAK),'''')NOKONTRAK, A.KDP3, isnull((DP3.NMP3),'''')NMP3, 
A.KETOTOR,rtrim(A.KEYBEND) as KEYBEND,A.NOREG,A.NOSP2D, A.NOSPM,A.PENOLAKAN,A.TGLSP2D,A.TGLSPM,
A.TGLVALID,A.UNITKEY ,SK.NOSKO,SK.TGLSKO,isnull(D.KDKEGUNIT, @param1 ) as KDKEGUNIT, A.NOBBANTU,
C.NMBKAS,K.TGLKON 
from SP2D A 
LEFT OUTER JOIN SP2DDETR D ON A.NOSP2D = D.NOSP2D and A.UNITKEY = D.UNITKEY 
LEFT OUTER JOIN SKO SK ON A.IDXSKO = SK.IDXSKO and A.UNITKEY = SK.UNITKEY 
LEFT OUTER JOIN DAFTPHK3 DP3 ON A.KDP3 = DP3.KDP3 
left outer join BKBKAS C on A.NOBBANTU = C.NOBBANTU 
LEFT OUTER JOIN KONTRAK K ON A.NOKONTRAK = K.NOKON 
where 
A.UNITKEY= @param2 and A.IDXKODE= @param3 and KDSTATUS in (''24'',''25'') and 
(isnull(D.KDKEGUNIT,'''')=isnull( @param1 ,'''') or isnull( @param1 ,'''')='''' or ((D.KDKEGUNIT is null) and @param1 is not null))
order by A.NOSP2D
@param0=0,@param1=N'8765_',@param2=N'2560_',@param3=2,@param4=N'1',@param5=N''